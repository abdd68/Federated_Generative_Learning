04/30/2024 03:09:56 - INFO - __main__ - ***** Running training *****
04/30/2024 03:09:56 - INFO - __main__ -   Num examples = 12894
04/30/2024 03:09:56 - INFO - __main__ -   Num batches each epoch = 2856
04/30/2024 03:09:56 - INFO - __main__ -   Num Epochs = 1
04/30/2024 03:09:56 - INFO - __main__ -   Instantaneous batch size per device = 1
04/30/2024 03:09:56 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 1
04/30/2024 03:09:56 - INFO - __main__ -   Gradient Accumulation steps = 1
04/30/2024 03:09:56 - INFO - __main__ -   Total optimization steps = 500
Steps:   0%|                                                                                                                      | 0/500 [00:00<?, ?it/s]
> /codespace/Federated_Generative_Learning/train_dreambooth_lora.py(1200)main()
-> pixel_values = batch["pixel_values"].to(dtype=weight_dtype)
[tensor([[[[-0.6452, -0.5253, -0.5253,  ..., -2.1179, -2.1008, -2.0494],
          [-0.8507, -0.7822, -0.8849,  ..., -1.6555, -1.2103, -0.8507],
          [-1.0904, -1.0219, -1.1932,  ..., -0.4568,  0.0912,  0.3823],
          ...,
          [-1.1932, -1.2274, -1.3815,  ...,  0.5878,  0.2796, -0.8507],
          [-1.1418, -1.1760, -1.3644,  ...,  0.9303,  0.9303, -0.4397],
          [-1.1075, -1.1247, -1.3473,  ...,  0.9646,  1.1872, -0.3541]],
         [[-1.0553, -1.0378, -1.1954,  ..., -0.1099,  0.0651,  0.4678],
          [-1.4055, -1.4930, -1.6331,  ...,  0.5903,  1.0280,  1.3782],
          [-1.7031, -1.7906, -1.8606,  ...,  1.4132,  1.7808,  1.9209],
          ...,
          [-1.6506, -1.7031, -1.7906,  ...,  1.1856,  0.6429, -0.7927],
          [-1.5805, -1.6331, -1.7731,  ...,  1.2556,  1.1331, -0.5126],
          [-1.5280, -1.5630, -1.7556,  ...,  1.0980,  1.2381, -0.5476]],
         [[-1.2467, -1.1770, -1.1247,  ...,  1.0714,  1.2805,  1.3677],
          [-1.3861, -1.4210, -1.3687,  ...,  1.4025,  1.8731,  2.0300],
          [-1.4733, -1.5604, -1.4907,  ...,  1.8905,  2.2217,  2.3263],
          ...,
          [-1.4036, -1.4210, -1.5081,  ...,  1.1759,  0.6879, -0.6193],
          [-1.3339, -1.3513, -1.4733,  ...,  1.0017,  0.9145, -0.5321],
          [-1.2641, -1.2641, -1.4384,  ...,  0.6705,  0.8448, -0.7413]]]],
       device='cuda:0'), tensor([5], device='cuda:0')]
*** TypeError: list indices must be integers or slices, not str
  File "train_dreambooth_lora.py", line 1421, in <module>                                                                         | 0/500 [00:00<?, ?it/s]
  File "train_dreambooth_lora.py", line 1200, in main
  File "train_dreambooth_lora.py", line 1200, in main
  File "/opt/conda/envs/fgl/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/opt/conda/envs/fgl/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit